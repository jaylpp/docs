---
title: 'æŸ¥è¯¢ç”¨æˆ·ä½™é¢'
openapi: 'GET /billing/balance'
description: 'æŸ¥è¯¢å½“å‰ç”¨æˆ·çš„è´¦æˆ·ä½™é¢ä¿¡æ¯ï¼ŒåŒ…æ‹¬å½“å‰ä½™é¢ã€ç´¯è®¡å……å€¼ã€ç´¯è®¡æ¶ˆè´¹ç­‰'
---

## æ¥å£è¯´æ˜

ç”¨æˆ·ä½™é¢æŸ¥è¯¢æ¥å£æä¾›è´¦æˆ·çš„å®Œæ•´è´¢åŠ¡ä¿¡æ¯ï¼Œå¸®åŠ©æ‚¨å®æ—¶äº†è§£è´¦æˆ·çŠ¶æ€ã€‚

### ä¸»è¦ç‰¹æ€§

- **å®æ—¶ä½™é¢ï¼š** æŸ¥è¯¢å½“å‰å¯ç”¨ä½™é¢
- **ç´¯è®¡ç»Ÿè®¡ï¼š** æ˜¾ç¤ºç´¯è®¡å……å€¼å’Œæ¶ˆè´¹é‡‘é¢
- **å¿«é€Ÿå“åº”ï¼š** æ— éœ€å¤æ‚è®¡ç®—ï¼Œç›´æ¥è¿”å›ç»“æœ
- **å®‰å…¨è®¤è¯ï¼š** æ”¯æŒAPI Keyå’ŒJWTåŒé‡è®¤è¯

## è®¤è¯æ–¹å¼

<ParamField header="Authorization" type="string" required>
  Bearer Tokenè®¤è¯ï¼Œæ”¯æŒAPI Keyæˆ–JWT Token

  ```
  Authorization: Bearer ak_xxxxxxxxxxxxxxxx
  ```
</ParamField>

## è¯·æ±‚å‚æ•°

<Note>
  æ­¤æ¥å£æ— éœ€è¯·æ±‚å‚æ•°ï¼Œç›´æ¥GETè¯·æ±‚å³å¯ã€‚
</Note>

## å“åº”å‚æ•°

<ResponseField name="user_id" type="integer" required>
  ç”¨æˆ·ID

  ```json
  123
  ```
</ResponseField>

<ResponseField name="current_balance" type="string" required>
  å½“å‰è´¦æˆ·ä½™é¢ï¼ˆå…ƒï¼‰

  ä½¿ç”¨å­—ç¬¦ä¸²æ ¼å¼ä¿è¯ç²¾åº¦ï¼Œé¿å…æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜

  ```json
  "158.50"
  ```
</ResponseField>

<ResponseField name="total_recharged" type="string" required>
  ç´¯è®¡å……å€¼é‡‘é¢ï¼ˆå…ƒï¼‰

  ç”¨æˆ·æ³¨å†Œä»¥æ¥çš„æ‰€æœ‰å……å€¼æ€»å’Œ

  ```json
  "500.00"
  ```
</ResponseField>

<ResponseField name="total_consumed" type="string" required>
  ç´¯è®¡æ¶ˆè´¹é‡‘é¢ï¼ˆå…ƒï¼‰

  ç”¨æˆ·æ³¨å†Œä»¥æ¥çš„æ‰€æœ‰æ¶ˆè´¹æ€»å’Œ

  ```json
  "341.50"
  ```
</ResponseField>

<ResponseField name="created_at" type="string" required>
  è´¦æˆ·åˆ›å»ºæ—¶é—´ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰

  æ ¼å¼ï¼šISO 8601

  ```json
  "2025-01-15T10:30:00+08:00"
  ```
</ResponseField>

<ResponseField name="updated_at" type="string" required>
  è´¦æˆ·æœ€åæ›´æ–°æ—¶é—´ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰

  æ¯æ¬¡å……å€¼æˆ–æ¶ˆè´¹åæ›´æ–°

  ```json
  "2025-09-30T14:20:00+08:00"
  ```
</ResponseField>

## è¯·æ±‚ç¤ºä¾‹

<CodeGroup>

```bash cURL
curl -X GET https://paperpanda.cn/api/v1/billing/balance \
  -H "Authorization: Bearer ak_xxxxxxxxxxxxxxxx"
```

```python Python
import requests

url = "https://paperpanda.cn/api/v1/billing/balance"
headers = {
    "Authorization": "Bearer ak_xxxxxxxxxxxxxxxx"
}

response = requests.get(url, headers=headers)
balance = response.json()

print(f"å½“å‰ä½™é¢: {balance['current_balance']}å…ƒ")
print(f"ç´¯è®¡å……å€¼: {balance['total_recharged']}å…ƒ")
print(f"ç´¯è®¡æ¶ˆè´¹: {balance['total_consumed']}å…ƒ")
```

```javascript JavaScript
const axios = require('axios');

const getBalance = async () => {
  try {
    const response = await axios.get(
      'https://paperpanda.cn/api/v1/billing/balance',
      {
        headers: {
          'Authorization': 'Bearer ak_xxxxxxxxxxxxxxxx'
        }
      }
    );

    const balance = response.data;

    console.log(`å½“å‰ä½™é¢: ${balance.current_balance}å…ƒ`);
    console.log(`ç´¯è®¡å……å€¼: ${balance.total_recharged}å…ƒ`);
    console.log(`ç´¯è®¡æ¶ˆè´¹: ${balance.total_consumed}å…ƒ`);
  } catch (error) {
    console.error('æŸ¥è¯¢å¤±è´¥:', error.response?.data || error.message);
  }
};

getBalance();
```

```java Java
import java.net.http.*;
import java.net.URI;
import com.google.gson.Gson;

public class GetBalance {
    public static void main(String[] args) throws Exception {
        String apiKey = "ak_xxxxxxxxxxxxxxxx";
        String url = "https://paperpanda.cn/api/v1/billing/balance";

        // åˆ›å»ºHTTPå®¢æˆ·ç«¯
        HttpClient client = HttpClient.newHttpClient();
        HttpRequest request = HttpRequest.newBuilder()
            .uri(URI.create(url))
            .header("Authorization", "Bearer " + apiKey)
            .GET()
            .build();

        // å‘é€è¯·æ±‚
        HttpResponse<String> response = client.send(
            request,
            HttpResponse.BodyHandlers.ofString()
        );

        System.out.println("ä½™é¢ä¿¡æ¯: " + response.body());
    }
}
```

```go Go
package main

import (
    "fmt"
    "io/ioutil"
    "net/http"
)

func main() {
    apiKey := "ak_xxxxxxxxxxxxxxxx"
    url := "https://paperpanda.cn/api/v1/billing/balance"

    // åˆ›å»ºè¯·æ±‚
    req, _ := http.NewRequest("GET", url, nil)
    req.Header.Set("Authorization", "Bearer " + apiKey)

    // å‘é€è¯·æ±‚
    client := &http.Client{}
    resp, err := client.Do(req)
    if err != nil {
        panic(err)
    }
    defer resp.Body.Close()

    // è¯»å–å“åº”
    body, _ := ioutil.ReadAll(resp.Body)
    fmt.Println("ä½™é¢ä¿¡æ¯:", string(body))
}
```

</CodeGroup>

## å“åº”ç¤ºä¾‹

<ResponseExample>

```json æˆåŠŸå“åº”
{
  "user_id": 123,
  "current_balance": "158.50",
  "total_recharged": "500.00",
  "total_consumed": "341.50",
  "created_at": "2025-01-15T10:30:00+08:00",
  "updated_at": "2025-09-30T14:20:00+08:00"
}
```

```json æ–°ç”¨æˆ·å“åº”
{
  "user_id": 456,
  "current_balance": "0.00",
  "total_recharged": "0.00",
  "total_consumed": "0.00",
  "created_at": "2025-09-30T15:00:00+08:00",
  "updated_at": "2025-09-30T15:00:00+08:00"
}
```

</ResponseExample>

## é”™è¯¯ç è¯´æ˜

| HTTPçŠ¶æ€ç  | è¯´æ˜ | å¤„ç†å»ºè®® |
|-----------|------|---------|
| 401 | API Keyæ— æ•ˆæˆ–å·²è¿‡æœŸ | æ£€æŸ¥å¯†é’¥æ˜¯å¦æ­£ç¡®ï¼Œæˆ–é‡æ–°ç”Ÿæˆå¯†é’¥ |
| 403 | æ¥å£è®¿é—®è¢«ç¦æ­¢ | è”ç³»ç®¡ç†å‘˜å¼€é€šæ¥å£æƒé™ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | ç¨åé‡è¯•ï¼Œæˆ–è”ç³»æŠ€æœ¯æ”¯æŒ |

## ä½¿ç”¨åœºæ™¯

<AccordionGroup>
  <Accordion title="è°ƒç”¨ä»˜è´¹æ¥å£å‰æ£€æŸ¥ä½™é¢">
    åœ¨è°ƒç”¨ AIGC æ”¹å†™ç­‰ä»˜è´¹æ¥å£å‰ï¼Œå»ºè®®å…ˆæŸ¥è¯¢ä½™é¢ï¼š

    ```python
    # 1. æŸ¥è¯¢ä½™é¢
    balance_response = requests.get(balance_url, headers=headers)
    balance = float(balance_response.json()['current_balance'])

    # 2. é¢„ä¼°è´¹ç”¨
    estimated_cost = len(content) / 1000 * unit_price

    # 3. åˆ¤æ–­æ˜¯å¦è¶³å¤Ÿ
    if balance >= estimated_cost:
        # è°ƒç”¨æ”¹å†™æ¥å£
        rewrite_response = requests.post(rewrite_url, ...)
    else:
        print(f"ä½™é¢ä¸è¶³ï¼å½“å‰: {balance}å…ƒï¼Œéœ€è¦: {estimated_cost}å…ƒ")
    ```
  </Accordion>

  <Accordion title="å®ç°ä½™é¢ç›‘æ§å’Œé¢„è­¦">
    å®šæœŸæŸ¥è¯¢ä½™é¢ï¼Œå®ç°ä½™é¢é¢„è­¦åŠŸèƒ½ï¼š

    ```python
    import time

    def monitor_balance(threshold=50.0):
        """ç›‘æ§ä½™é¢ï¼Œä½äºé˜ˆå€¼æ—¶å‘é€é¢„è­¦"""
        while True:
            response = requests.get(balance_url, headers=headers)
            balance = float(response.json()['current_balance'])

            if balance < threshold:
                send_alert(f"ä½™é¢ä¸è¶³é¢„è­¦ï¼å½“å‰ä½™é¢: {balance}å…ƒ")

            time.sleep(3600)  # æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡
    ```
  </Accordion>

  <Accordion title="åœ¨ç•Œé¢å®æ—¶æ˜¾ç¤ºä½™é¢">
    ä¸ºç”¨æˆ·æä¾›æ¸…æ™°çš„ä½™é¢æ˜¾ç¤ºï¼š

    ```javascript
    // é¡µé¢åŠ è½½æ—¶è·å–ä½™é¢
    async function loadBalance() {
      const response = await fetch('/api/v1/billing/balance', {
        headers: { 'Authorization': `Bearer ${apiKey}` }
      });
      const data = await response.json();

      // æ›´æ–°UI
      document.getElementById('balance').innerText =
        `Â¥${data.current_balance}`;
      document.getElementById('total-recharged').innerText =
        `ç´¯è®¡å……å€¼: Â¥${data.total_recharged}`;
      document.getElementById('total-consumed').innerText =
        `ç´¯è®¡æ¶ˆè´¹: Â¥${data.total_consumed}`;
    }
    ```
  </Accordion>

  <Accordion title="è®¡ç®—å¯ç”¨æœåŠ¡æ¬¡æ•°">
    æ ¹æ®ä½™é¢è®¡ç®—è¿˜èƒ½è°ƒç”¨å¤šå°‘æ¬¡æœåŠ¡ï¼š

    ```python
    # è·å–ä½™é¢
    balance_response = requests.get(balance_url, headers=headers)
    balance = float(balance_response.json()['current_balance'])

    # å‡è®¾å•æ¬¡æ”¹å†™å¹³å‡è´¹ç”¨ 0.5 å…ƒ
    average_cost = 0.5
    available_times = int(balance / average_cost)

    print(f"å½“å‰ä½™é¢å¯è¿›è¡Œçº¦ {available_times} æ¬¡æ”¹å†™")
    ```
  </Accordion>
</AccordionGroup>

## æ•°æ®ç²¾åº¦è¯´æ˜

<Warning>
  **é‡è¦ï¼š** ä½™é¢å­—æ®µä½¿ç”¨å­—ç¬¦ä¸²æ ¼å¼è€Œéæ•°å­—ï¼Œä»¥ä¿è¯ç²¾åº¦ã€‚

  ```python
  # âœ… æ­£ç¡®åšæ³•
  balance = Decimal(response.json()['current_balance'])

  # âŒ é¿å…ç›´æ¥ä½¿ç”¨floatï¼ˆå¯èƒ½æŸå¤±ç²¾åº¦ï¼‰
  balance = float(response.json()['current_balance'])
  ```
</Warning>

åœ¨è¿›è¡Œé‡‘é¢è®¡ç®—æ—¶ï¼Œå»ºè®®ä½¿ç”¨é«˜ç²¾åº¦æ•°å€¼ç±»å‹ï¼š

- **Python:** ä½¿ç”¨ `decimal.Decimal`
- **JavaScript:** ä½¿ç”¨ `Big.js` æˆ– `decimal.js`
- **Java:** ä½¿ç”¨ `BigDecimal`

## æ—¶åŒºè¯´æ˜

<Info>
  æ‰€æœ‰æ—¶é—´å­—æ®µå‡å·²è½¬æ¢ä¸º **åŒ—äº¬æ—¶é—´ï¼ˆUTC+8ï¼‰**ï¼Œæ— éœ€å®¢æˆ·ç«¯å†æ¬¡è½¬æ¢ã€‚
</Info>

ç¤ºä¾‹æ—¶é—´æ ¼å¼ï¼š
```
2025-09-30T14:20:00+08:00
```

è§£æç¤ºä¾‹ï¼š
```python
from datetime import datetime

time_str = "2025-09-30T14:20:00+08:00"
dt = datetime.fromisoformat(time_str)
print(dt)  # 2025-09-30 14:20:00+08:00
```

## æœ€ä½³å®è·µ

### 1. ç¼“å­˜ä½™é¢ä¿¡æ¯

é¿å…é¢‘ç¹æŸ¥è¯¢ï¼Œåˆç†ä½¿ç”¨ç¼“å­˜ï¼š

```python
import time

class BalanceCache:
    def __init__(self, ttl=300):  # ç¼“å­˜5åˆ†é’Ÿ
        self.balance = None
        self.last_update = 0
        self.ttl = ttl

    def get_balance(self):
        now = time.time()
        if not self.balance or (now - self.last_update) > self.ttl:
            # ç¼“å­˜è¿‡æœŸï¼Œé‡æ–°è·å–
            response = requests.get(balance_url, headers=headers)
            self.balance = response.json()
            self.last_update = now
        return self.balance
```

### 2. é”™è¯¯å¤„ç†

å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼š

```python
def get_balance_safe():
    """å®‰å…¨åœ°è·å–ä½™é¢ï¼ŒåŒ…å«é‡è¯•å’Œé”™è¯¯å¤„ç†"""
    max_retries = 3

    for i in range(max_retries):
        try:
            response = requests.get(
                balance_url,
                headers=headers,
                timeout=10
            )
            response.raise_for_status()
            return response.json()
        except requests.exceptions.Timeout:
            if i == max_retries - 1:
                raise Exception("æŸ¥è¯¢è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ")
            time.sleep(1)
        except requests.exceptions.HTTPError as e:
            if e.response.status_code == 401:
                raise Exception("API Keyæ— æ•ˆï¼Œè¯·æ£€æŸ¥")
            raise
```

### 3. ä½™é¢å˜åŒ–ç›‘å¬

ç›‘å¬ä½™é¢å˜åŒ–ï¼ŒåŠæ—¶æ›´æ–°UIï¼š

```javascript
class BalanceMonitor {
  constructor(apiKey, onUpdate) {
    this.apiKey = apiKey;
    this.onUpdate = onUpdate;
    this.lastBalance = null;
  }

  async start(interval = 30000) {  // 30ç§’æ£€æŸ¥ä¸€æ¬¡
    setInterval(async () => {
      const balance = await this.fetchBalance();

      if (this.lastBalance &&
          balance.current_balance !== this.lastBalance.current_balance) {
        // ä½™é¢å‘ç”Ÿå˜åŒ–
        this.onUpdate(balance, this.lastBalance);
      }

      this.lastBalance = balance;
    }, interval);
  }

  async fetchBalance() {
    const response = await fetch('/api/v1/billing/balance', {
      headers: { 'Authorization': `Bearer ${this.apiKey}` }
    });
    return response.json();
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const monitor = new BalanceMonitor(apiKey, (newBalance, oldBalance) => {
  console.log(`ä½™é¢å˜åŒ–: ${oldBalance.current_balance} -> ${newBalance.current_balance}`);
  updateUI(newBalance);
});

monitor.start();
```

## å¸¸è§é—®é¢˜

<AccordionGroup>
  <Accordion title="ä¸ºä»€ä¹ˆä½™é¢æ˜¾ç¤ºä¸ºå­—ç¬¦ä¸²è€Œä¸æ˜¯æ•°å­—ï¼Ÿ">
    ä½¿ç”¨å­—ç¬¦ä¸²æ ¼å¼å¯ä»¥é¿å…æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜ã€‚é‡‘èæ•°æ®å¯¹ç²¾åº¦è¦æ±‚æé«˜ï¼Œä½¿ç”¨å­—ç¬¦ä¸²+é«˜ç²¾åº¦åº“ï¼ˆå¦‚Decimalï¼‰æ˜¯ä¸šç•Œæœ€ä½³å®è·µã€‚
  </Accordion>

  <Accordion title="ä½™é¢æ›´æ–°çš„å»¶è¿Ÿæ˜¯å¤šå°‘ï¼Ÿ">
    ä½™é¢æ›´æ–°æ˜¯å®æ—¶çš„ã€‚å½“æ‚¨å……å€¼æˆ–æ¶ˆè´¹åï¼Œç«‹å³è°ƒç”¨æ­¤æ¥å£å³å¯è·å¾—æœ€æ–°ä½™é¢ã€‚
  </Accordion>

  <Accordion title="å¦‚ä½•è®¡ç®—å¯ç”¨ä½™é¢èƒ½åšå¤šå°‘æ¬¡æ”¹å†™ï¼Ÿ">
    ```python
    # é¢„ä¼°è®¡ç®—
    average_chars = 5000  # å¹³å‡å­—ç¬¦æ•°
    price_per_1000 = 2   # æ¯åƒå­—ä»·æ ¼ï¼ˆæ ¹æ®å®é™…æœåŠ¡ç±»å‹ï¼‰

    cost_per_rewrite = (average_chars / 1000) * price_per_1000
    available_times = int(balance / cost_per_rewrite)
    ```
  </Accordion>

  <Accordion title="ä½™é¢ä¸ºè´Ÿæ•°æ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿ">
    ç³»ç»Ÿæ”¯æŒæ¬ è´¹ä¿æŠ¤æœºåˆ¶ã€‚å½“ä½™é¢ä¸è¶³ä½†æœåŠ¡å·²å®Œæˆæ—¶ï¼Œä¼šåˆ›å»ºæ¬ è´¹è®¢å•ï¼Œä½™é¢å¯èƒ½å˜ä¸ºè´Ÿæ•°ã€‚å……å€¼å›æ­£åï¼Œå¯ä»¥æŸ¥çœ‹æ¬ è´¹æœŸé—´çš„å¤„ç†ç»“æœã€‚
  </Accordion>
</AccordionGroup>

## æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿæˆ‘ä»¬éšæ—¶ä¸ºæ‚¨æä¾›å¸®åŠ©ï¼š

- ğŸ“§ é‚®ç®±ï¼šsupport@paperpanda.cn
- ğŸ“š å®Œæ•´æ–‡æ¡£ï¼šhttps://docs.paperpanda.cn
- ğŸ’¬ åœ¨çº¿å®¢æœï¼šå¹³å°å³ä¸‹è§’
